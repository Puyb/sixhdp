{% extends "base.html" %}
{% load i18n %}
{% block content %}
<h1>{% trans 'Votre inscription est enregistrée' %}</h1>
<table>
    <tr><th>{% trans 'Equipe : ' %}</th><td>{{ instance.nom }}</td></tr>
    <tr><th>{% trans "Numéro d'inscription :" %}</th><td>{{ instance.id }}</td></tr>
</table>
<br />
{% trans 'Un email de confirmation vient de vous être envoyé.' %}<br />
<br />
{% if not instance.paiement_complet %}
{% trans 'Pour régler votre inscription vous pouvez payer par internet :' %}

{% block payment_form %}
<form action="{{ PAYPAL_URL }}" method="post">
    <input type="hidden" name="business"      value="{{ PAYPAL_BUSINESS }}" />
    <input type="hidden" name="currency_code" value="EUR" />
    <input type="hidden" name="return"        value="" id="paypal_return_url" />
    <input type="hidden" name="cmd"           value="_cart" />
    <input type="hidden" name="upload"        value="1" />
    <input type="hidden" name="no_shipping"   value="1" />
    <input type="hidden" name="invoice"       value="{{ instance.id }}" />
    <input type="hidden" name="item_name_1"   value="6H de Paris - {{ instance.categorie }}" />
    <input type="hidden" name="amount_1"      value="{{ instance.prix_paypal|floatformat:2 }}" />
    <input type="hidden" name="quantity_1"    value="1" />
    {# LEAVE THE HANDLING CHARGE ALONE!  PAYPAL SHIPPING WILL INEVITABLY BE MESSED UP IF YOU USE THEIR SHIPPING METHODS #}
    {# To work around their bizarre system, we are telling Paypal "no shipping" and adding all shipping charges as handling #}
    <input type="hidden" name="handling_cart" value="0.00" />
    <input type="hidden" name="tax_cart"      value="0.00" />
    <input type="hidden" name="notify_url"    value="{{ paypal_ipn_url }}" />

    <input type="submit" value="{% trans 'Paypal ou Carte bancaire' %}"><br />
</form>
<script> document.getElementById('paypal_return_url').value = location.href; </script>
{% endblock %}






{% blocktrans with frais=instance.frais_paypal|floatformat:2 %}Pour tout paiement par internet, {{ frais }} € de frais seront ajoutés.{% endblocktrans %}<br />
<br />
{% blocktrans with prix=instance.prix %}Ou envoyer un chèque de {{ prix }} € à l'ordre du "Paris Université Club".{% endblocktrans %}<br />
{% else %}
{% blocktrans with prix=instance.paiement %}Votre paiement de {{ prix }} € à bien été reçu.{% endblocktrans %}
{% endif %}

<p>
{% if instance.licence_manquantes %}
    {% trans 'Il manque les licences de :' %} <ul>
    {% for e in instance.licence_manquantes %}
    <li>{{ e.prenom }} {{ e.nom }}</li>
    {% endfor %}
    </ul>
{% endif %}

{% if instance.certificat_manquantes %}
    {% trans 'Il manque les certificats médicaux de :' %}<ul>
    {% for e in instance.certificat_manquantes %}
    <li>{{ e.prenom }} {{ e.nom }}</li>
    {% endfor %}
    </ul>
{% endif %}

{% if instance.autorisation_manquantes %}
    {% trans 'Il manque les autorisations parentales :' %}<ul>
    {% for e in instance.autorisation_manquantes %}
    <li>{{ e.prenom }} {{ e.nom }}</li>
    {% endfor %}
    </ul>
{% endif %}

{% if instance.categorie == "EPX" and not instance.piece_jointe_valide and not instance.piece_jointe %}
{% blocktrans %}Il manque le certificat pour votre inscription en catégorie entreprise (<a href="http://6hdeparis.fr/certificat_employeur.pdf" target="_blank">modèle</a>).{% endblocktrans %}<br />
{% endif %}

</p>

{% if not instance.paiement or instance.licence_manquantes or instance.certificat_manquantes or instance.autorisation_manquantes %}
{% trans 'Vous pouvez envoyer le paiement et les justificatifs à' %} <br />
<pre>{% blocktrans %}PUC - 6h Roller de Paris
17 avenue Pierre de Coubertin
75013 Paris{% endblocktrans %}</pre>
<br />
{% trans "En précisant le nom de votre équipe et le numéro d'inscription ci dessus." %}
{% endif %}

{% endblock %}
